<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulário de Trabalho Seguro</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --primary-color: #3498db;
        --secondary-color: #2c3e50;
        --accent-color: #4893c5;
        --light-color: #f8f9fa;
        --dark-color: #343a40;
      }

      body {
        font-family: "Inter", sans-serif;
        background: #f5f5f5;
        padding: 20px;
      }

      .navbar {
        background-color: var(--primary-color);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      .navbar-brand {
        font-weight: 700;
        color: white !important;
      }

      .nav-link {
        color: white !important;
        font-weight: 500;
        transition: all 0.3s;
      }

      .nav-link:hover {
        transform: translateY(-2px);
        color: var(--light-color) !important;
      }

      .form-container {
        background: white;
        padding: 30px;
        max-width: 900px;
        margin: 20px auto;
        border-radius: 12px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
      }

      h2 {
        margin-bottom: 20px;
        color: var(--primary-color);
        border-bottom: 2px solid var(--primary-color);
        padding-bottom: 10px;
        font-weight: 600;
      }

      label {
        font-weight: 600;
        margin-top: 12px;
        display: block;
        color: var(--secondary-color);
      }

      .checkbox-group {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 8px;
        margin-bottom: 20px;
        border: 1px solid #e9ecef;
      }

      .checkbox-group label {
        margin-top: 8px;
        display: block;
        font-weight: 400;
      }

      input[type="text"],
      input[type="email"],
      input[type="time"],
      textarea {
        width: 100%;
        padding: 12px;
        margin-top: 6px;
        margin-bottom: 16px;
        border: 1px solid #ced4da;
        border-radius: 6px;
        transition: border-color 0.3s;
      }

      input[type="text"]:focus,
      input[type="email"]:focus,
      input[type="time"]:focus,
      textarea:focus {
        border-color: var(--primary-color);
        box-shadow: 0 0 0 0.2rem rgba(255, 107, 0, 0.25);
        outline: none;
      }

      .hidden {
        display: none;
      }

      .result-box {
        background: #f8f9fa;
        padding: 15px;
        margin-top: 15px;
        border-radius: 8px;
        border-left: 4px solid var(--primary-color);
      }

      button {
        margin-top: 30px;
        padding: 14px 24px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: all 0.3s;
        display: block;
        width: 100%;
      }

      button:hover {
        background: #e05e00;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .time-inputs {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
      }

      .time-inputs div {
        flex: 1;
      }

      .form-section {
        margin-bottom: 30px;
        padding-bottom: 20px;
        border-bottom: 1px solid #e9ecef;
      }

      .form-section:last-child {
        border-bottom: none;
      }

      .checkbox-group input[type="checkbox"] {
        margin-right: 8px;
      }

      .alert {
        margin-top: 20px;
      }

      .footer {
        background-color: var(--secondary-color);
        color: white;
        padding: 15px 0;
        margin-top: 40px;
        text-align: center;
      }

      @media (max-width: 768px) {
        .form-container {
          padding: 20px;
        }

        .time-inputs {
          flex-direction: column;
          gap: 0;
        }
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <div class="container">
        <a class="navbar-brand" href="index.html">
          <i class="fas fa-hard-hat me-2"></i>
          Segurança do Trabalho
        </a>
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNav"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ms-auto">
            <li class="nav-item">
              <a class="nav-link" href="index.html"
                ><i class="fas fa-home me-1"></i> Home</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="formularios.html"
                ><i class="fas fa-file-alt me-1"></i> Formulários</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="cadastro.html"
                ><i class="fas fa-plus-circle me-1"></i> Novo Formulário</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"
                ><i class="fas fa-sign-out-alt me-1"></i> Sair</a
              >
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container">
      <div class="form-container">
        <h2 class="text-center mb-4">
          <i class="fas fa-clipboard-check me-2"></i>Formulário de Trabalho
          Seguro
        </h2>

        <div id="alert-container"></div>

        <form id="formulario">
          <!-- Etapa 1: Dados do trabalhador -->
          <div class="form-section">
            <h3><i class="fas fa-user me-2"></i>Etapa 1: Identificação</h3>
            <div class="row">
              <div class="col-md-6">
                <label for="nome_dos_trabalhadores"
                  >Nome dos Trabalhadores</label
                >
                <input
                  type="text"
                  id="nome_dos_trabalhadores"
                  name="nome_dos_trabalhadores"
                  required
                />
              </div>
              <div class="col-md-6">
                <label for="nome_de_empresa">Empresa</label>
                <input
                  type="text"
                  id="nome_de_empresa"
                  name="nome_de_empresa"
                  required
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-6">
                <label for="setor">Setor</label>
                <input type="text" id="setor" name="setor" required />
              </div>
              <div class="col-md-6">
                <label for="numero_do_ptp">Número do PTP</label>
                <input
                  type="text"
                  id="numero_do_ptp"
                  name="numero_do_ptp"
                  required
                />
              </div>
            </div>

            <div class="row">
              <div class="col-12">
                <label for="local_especifico"
                  >Local Específico do Trabalho</label
                >
                <input
                  type="text"
                  id="local_especifico"
                  name="local_especifico"
                  required
                  placeholder="Descreva o local exato onde será realizado o trabalho"
                />
              </div>
            </div>

            <div class="row">
              <div class="col-12">
                <label for="endereco_comercial">Endereço Comercial</label>
                <input
                  type="text"
                  id="endereco_comercial"
                  name="endereco_comercial"
                  required
                />
              </div>
            </div>

            <div class="time-inputs">
              <div>
                <label for="hora_inicio">Hora de Início</label>
                <input
                  type="time"
                  id="hora_inicio"
                  name="hora_inicio"
                  required
                />
              </div>
              <div>
                <label for="hora_termino">Previsão de Término</label>
                <input
                  type="time"
                  id="hora_termino"
                  name="hora_termino"
                  required
                />
              </div>
            </div>
          </div>

          <!-- Etapa 2: Tipo de trabalho -->
          <div class="form-section">
            <h3><i class="fas fa-tools me-2"></i>Etapa 2: Tipo de Trabalho</h3>
            <div class="checkbox-group">
              <label>
                <input
                  type="checkbox"
                  id="trabalho_em_altura"
                  name="trabalho_em_altura"
                  value="Sim"
                  onchange="mostrarRiscos(this, 'altura')"
                />
                Trabalho em Altura
              </label>
              <label>
                <input
                  type="checkbox"
                  id="espaco_confinado"
                  name="espaco_confinado"
                  value="Sim"
                  onchange="mostrarRiscos(this, 'espaco-confinado')"
                />
                Espaço Confinado
              </label>
              <label>
                <input
                  type="checkbox"
                  id="icamento_de_cargas"
                  name="icamento_de_cargas"
                  value="Sim"
                  onchange="mostrarRiscos(this, 'icamento')"
                />
                Içamento de carga
              </label>
              <label>
                <input
                  type="checkbox"
                  id="equipamentos_moveis"
                  name="equipamentos_moveis"
                  value="Sim"
                  onchange="mostrarRiscos(this, 'equipamentos-moveis')"
                />
                Equipamentos móveis
              </label>
              <label>
                <input
                  type="checkbox"
                  id="energias_perigosas"
                  name="energias_perigosas"
                  value="Sim"
                  onchange="mostrarRiscos(this, 'energia-perigosa')"
                />
                Energia Perigosa
              </label>
            </div>

            <!-- Campo de outras atividades -->
            <label for="outras_atividades"
              >Outras atividades (especifique)</label
            >
            <textarea
              id="outras_atividades"
              name="outras_atividades"
              rows="3"
              placeholder="Descreva outras atividades relevantes"
            ></textarea>
          </div>

          <!-- Seções de Riscos para cada tipo de trabalho -->
          <div class="form-section">
            <!-- Trabalho em Altura -->
            <div id="riscos-altura" class="hidden">
              <h3>
                <i class="fas fa-exclamation-triangle me-2"></i>Riscos -
                Trabalho em Altura
              </h3>
              <div class="checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    value="Queda de altura"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Queda de altura
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Choque contra estruturas"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Choque contra estruturas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Queda de materiais sobre pessoas abaixo"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Queda de materiais sobre pessoas abaixo
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Choque elétrico"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Choque elétrico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Fadiga ou mal-estar do trabalhador"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Fadiga ou mal-estar do trabalhador
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falha ou uso inadequado dos EPIs"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Falha ou uso inadequado dos EPIs
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Condições climáticas adversas"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Condições climáticas adversas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Superfícies instáveis ou frágeis"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Superfícies instáveis ou frágeis
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Acesso inadequado ao local de trabalho"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Acesso inadequado ao local de trabalho
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falta de ancoragem ou fixação inadequada"
                    onchange="mostrarEPIs('Trabalho em Altura')"
                  />
                  Falta de ancoragem ou fixação inadequada
                </label>
              </div>
            </div>

            <!-- Içamento de Carga -->
            <div id="riscos-icamento" class="hidden">
              <h3>
                <i class="fas fa-exclamation-triangle me-2"></i>Riscos -
                Içamento de Carga
              </h3>
              <div class="checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    value="Queda de cargas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Queda de cargas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Sobrecargas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Sobrecargas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falta de comunicação"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Falta de comunicação
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falhas mecânicas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Falhas mecânicas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Más condições climáticas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Más condições climáticas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Choque elétrico"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Choque elétrico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Queda de pessoas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Queda de pessoas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Ruptura de cabos/cintas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Ruptura de cabos/cintas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Carga mal acondicionada ou instável"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Carga mal acondicionada ou instável
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Colisão da carga com estruturas"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Colisão da carga com estruturas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Erro humano"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Erro humano
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Trabalho em área não isolada"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Trabalho em área não isolada
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Uso de equipamentos inadequados"
                    onchange="mostrarEPIs('Içamento de carga')"
                  />
                  Uso de equipamentos inadequados
                </label>
              </div>
            </div>

            <!-- Espaço Confinado -->
            <div id="riscos-espaco-confinado" class="hidden">
              <h3>
                <i class="fas fa-exclamation-triangle me-2"></i>Riscos - Espaço
                Confinado
              </h3>
              <div class="checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    value="Falta de oxigênio"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Falta de oxigênio
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Ruídos"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Ruídos
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Gases tóxicos ou inflamáveis"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Gases tóxicos ou inflamáveis
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Calor excessivo"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Calor excessivo
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Umidade elevada"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Umidade elevada
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Riscos biológicos"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Riscos biológicos
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Riscos mecânicos"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Riscos mecânicos
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Atmosfera explosiva"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Atmosfera explosiva
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Iluminação inadequada"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Iluminação inadequada
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Risco de quedas"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Risco de quedas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Choque elétrico"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Choque elétrico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Movimentação de partes mecânicas"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Movimentação de partes mecânicas
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Estresse térmico"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Estresse térmico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Dificuldade de comunicação"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Dificuldade de comunicação
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Risco ergonômico"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Risco ergonômico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Contaminação cruzada"
                    onchange="mostrarEPIs('Espaço Confinado')"
                  />
                  Contaminação cruzada
                </label>
              </div>
            </div>

            <!-- Equipamentos Móveis -->
            <div id="riscos-equipamentos-moveis" class="hidden">
              <h3>
                <i class="fas fa-exclamation-triangle me-2"></i>Riscos -
                Equipamentos Móveis
              </h3>
              <div class="checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    value="Atropelamento"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Atropelamento
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Colisão"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Colisão
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Tombamento"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Tombamento
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Queda de materiais"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Queda de materiais
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Aprisionamento"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Aprisionamento
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Capotamento"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Capotamento
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Vibração excessiva"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Vibração excessiva
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Ruído elevado"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Ruído elevado
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Inalação de gases e vapores"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Inalação de gases e vapores
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falha mecânica"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Falha mecânica
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Risco elétrico"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Risco elétrico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Risco ergonômico"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Risco ergonômico
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Incêndio ou explosão"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Incêndio ou explosão
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Contato com partes quentes"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Contato com partes quentes
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Falta de visibilidade"
                    onchange="mostrarEPIs('Equipamentos móveis')"
                  />
                  Falta de visibilidade
                </label>
              </div>
            </div>

            <!-- Energia Perigosa -->
            <div id="riscos-energia-perigosa" class="hidden">
              <h3>
                <i class="fas fa-exclamation-triangle me-2"></i>Riscos - Energia
                Perigosa
              </h3>
              <div class="checkbox-group">
                <label>
                  <input
                    type="checkbox"
                    value="Elétrica"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Elétrica
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Hidráulica"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Hidráulica
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Pneumática"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Pneumática
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Química"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Química
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Mecânica"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Mecânica
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Térmica"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Térmica
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Radiação"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Radiação
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Gravitacional"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Gravitacional
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Residual"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Residual
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Cinética"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Cinética
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Sonora (ruído)"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Sonora (ruído)
                </label>
                <label>
                  <input
                    type="checkbox"
                    value="Lumínica (ofuscamento)"
                    onchange="mostrarEPIs('Energia Perigosa')"
                  />
                  Lumínica (ofuscamento)
                </label>
              </div>
            </div>
          </div>

          <!-- Seções de EPIs e Medidas para cada tipo de trabalho -->
          <div class="form-section">
            <div id="epis-altura" class="hidden">
              <h3>
                <i class="fas fa-shield-alt me-2"></i>EPIs e Medidas de Controle
                - Trabalho em Altura
              </h3>
              <div class="result-box" id="detalhes-altura"></div>
            </div>

            <div id="epis-icamento" class="hidden">
              <h3>
                <i class="fas fa-shield-alt me-2"></i>EPIs e Medidas de Controle
                - Içamento de Carga
              </h3>
              <div class="result-box" id="detalhes-icamento"></div>
            </div>

            <div id="epis-espaco-confinado" class="hidden">
              <h3>
                <i class="fas fa-shield-alt me-2"></i>EPIs e Medidas de Controle
                - Espaço Confinado
              </h3>
              <div class="result-box" id="detalhes-espaco-confinado"></div>
            </div>

            <div id="epis-equipamentos-moveis" class="hidden">
              <h3>
                <i class="fas fa-shield-alt me-2"></i>EPIs e Medidas de Controle
                - Equipamentos Móveis
              </h3>
              <div class="result-box" id="detalhes-equipamentos-moveis"></div>
            </div>

            <div id="epis-energia-perigosa" class="hidden">
              <h3>
                <i class="fas fa-shield-alt me-2"></i>EPIs e Medidas de Controle
                - Energia Perigosa
              </h3>
              <div class="result-box" id="detalhes-energia-perigosa"></div>
            </div>
          </div>

          <!-- Etapa 3: Assinaturas -->
          <div class="form-section">
            <h3><i class="fas fa-signature me-2"></i>Etapa 3: Assinaturas</h3>
            </div>

            <div class="row">
              <div class="col-md-12">
                <label for="assinatura_do_responavel_da_equipe_de_trabalho"
                  >Assinatura do Responsável da Equipe de Trabalho</label
                >
                <input
                  type="text"
                  id="assinatura_do_responavel_da_equipe_de_trabalho"
                  name="assinatura_do_responavel_da_equipe_de_trabalho"
                  required
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-12">
                <label for="assinatura_do_responsavel_do_sites"
                  >Assinatura do Responsável do Site</label
                >
                <input
                  type="text"
                  id="assinatura_do_responsavel_do_sites"
                  name="assinatura_do_responsavel_do_sites"
                  required
                />
              </div>
            </div>

            <div class="row">
              <div class="col-md-12">
                <label for="assinatura_do_tecnico_de_seguranca"
                  >Assinatura do Técnico de Segurança</label
                >
                <input
                  type="text"
                  id="assinatura_do_tecnico_de_seguranca"
                  name="assinatura_do_tecnico_de_seguranca"
                  required
                />
              </div>
            </div>
          </div>

          <button type="submit" id="submit-btn">
            <i class="fas fa-paper-plane me-2"></i>Enviar Formulário
          </button>
        </form>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <div class="container">
        <p class="mb-0">
          &copy; 2025 Segurança do Trabalho. Todos os direitos reservados.
        </p>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
   <script>
  // Dados embutidos para garantir que sempre haverá dados disponíveis
  const dadosRiscosEmbutidos = {
    "Trabalho em Altura": {
      "Queda de altura": {
        epis: [
          "Cinto de segurança tipo paraquedista",
          "Talabarte de segurança",
          "Capacete com jugular",
          "Calçado antiderrapante"
        ],
        medidas: [
          "Uso de linha de vida ou ponto de ancoragem certificado",
          "Inspeção dos EPIs antes do uso",
          "Treinamento específico para trabalho em altura",
          "Autorização para trabalho (PTP)"
        ]
      }
    },
    "Energia Perigosa": {
      "Elétrica": {
        epis: [
          "Luvas isolantes",
          "Bota com solado isolante",
          "Capacete com aba",
          "Roupas com proteção contra arco elétrico"
        ],
        medidas: [
          "Bloqueio e etiquetagem (LOTO)",
          "Teste de ausência de tensão",
          "Manutenção por eletricistas qualificados",
          "Isolamento e sinalização da área"
        ]
      }
    }
  };

  // Inicializa com os dados embutidos para garantir que sempre haverá dados
  let dadosRiscos = dadosRiscosEmbutidos;

  // Tenta carregar o JSON externo
  fetch("./riscos.json")
    .then(response => {
      if (!response.ok) {
        throw new Error("Falha ao carregar o arquivo JSON");
      }
      return response.json();
    })
    .then(data => {
      dadosRiscos = data;
      console.log("Dados de riscos carregados com sucesso do arquivo");
    })
    .catch(error => {
      console.error("Erro ao carregar dados:", error);
      console.log("Usando dados embutidos como fallback");
    });

  // Mapeamento entre IDs de checkbox e tipos de trabalho
  const mapeamentoTipos = {
    trabalho_em_altura: "altura",
    espaco_confinado: "espaco-confinado",
    icamento_de_cargas: "icamento",
    equipamentos_moveis: "equipamentos-moveis",
    energias_perigosas: "energia-perigosa",
  };

  // Mapeamento entre tipos formatados e nomes de atividades
  const mapeamentoAtividades = {
    altura: "Trabalho em Altura",
    "espaco-confinado": "Espaço Confinado",
    icamento: "Içamento de carga",
    "equipamentos-moveis": "Equipamentos móveis",
    "energia-perigosa": "Energia Perigosa",
  };

  function mostrarRiscos(checkbox, tipo) {
    console.log(`Mostrando riscos para tipo: ${tipo}, checked: ${checkbox.checked}`);
    const idRiscos = `riscos-${tipo}`;
    const riscosElement = document.getElementById(idRiscos);

    if (!riscosElement) {
      console.error(`Elemento com ID ${idRiscos} não encontrado`);
      return;
    }

    if (checkbox.checked) {
      riscosElement.classList.remove("hidden");
    } else {
      riscosElement.classList.add("hidden");

      // Esconde a seção de EPIs quando o tipo de trabalho é desmarcado
      const episElement = document.getElementById(`epis-${tipo}`);
      if (episElement) {
        episElement.classList.add("hidden");
      }
    }
  }

  function mostrarEPIs(atividade) {
    console.log(`Mostrando EPIs para atividade: ${atividade}`);
    
    // Encontra o tipo formatado a partir do nome da atividade
    let tipoFormatado = "";
    for (const [tipo, nome] of Object.entries(mapeamentoAtividades)) {
      if (nome === atividade) {
        tipoFormatado = tipo;
        break;
      }
    }

    if (!tipoFormatado) {
      console.error(`Tipo formatado não encontrado para atividade: ${atividade}`);
      return;
    }
    
    console.log(`Tipo formatado: ${tipoFormatado}`);

    const riscosSelecionados = [
      ...document.querySelectorAll(`#riscos-${tipoFormatado} input:checked`),
    ].map((el) => el.value);
    
    console.log(`Riscos selecionados: ${riscosSelecionados.join(", ")}`);

    const idDetalhes = `detalhes-${tipoFormatado}`;
    const detalhes = document.getElementById(idDetalhes);

    if (!detalhes) {
      console.error(`Elemento com ID ${idDetalhes} não encontrado`);
      return;
    }

    detalhes.innerHTML = "";

    if (riscosSelecionados.length === 0) {
      const episElement = document.getElementById(`epis-${tipoFormatado}`);
      if (episElement) {
        episElement.classList.add("hidden");
      }
      return;
    }

    // Verifica se os dados da atividade existem
    if (!dadosRiscos[atividade]) {
      console.error(`Dados não encontrados para atividade: ${atividade}`);
      console.log("Dados disponíveis:", Object.keys(dadosRiscos));
      return;
    }

    let conteudoGerado = false;

    riscosSelecionados.forEach((risco) => {
      console.log(`Processando risco: ${risco} para atividade: ${atividade}`);
      
      if (dadosRiscos[atividade] && dadosRiscos[atividade][risco]) {
        const info = dadosRiscos[atividade][risco];
        detalhes.innerHTML += `
          <div class="mb-3">
            <h5 class="text-primary"><i class="fas fa-exclamation-circle me-2"></i>${risco}</h5>
            <p><strong><i class="fas fa-hard-hat me-2"></i>EPIs:</strong> ${info.epis.join(", ")}</p>
            <p><strong><i class="fas fa-shield-alt me-2"></i>Medidas de Controle:</strong> ${info.medidas.join(", ")}</p>
          </div>
        `;
        conteudoGerado = true;
      } else {
        console.error(`Informações não encontradas para risco: ${risco} em atividade: ${atividade}`);
        console.log("Dados da atividade:", dadosRiscos[atividade]);
      }
    });

    const episElement = document.getElementById(`epis-${tipoFormatado}`);
    if (episElement) {
      if (conteudoGerado) {
        episElement.classList.remove("hidden");
      } else {
        episElement.classList.add("hidden");
      }
    }
  }

  // Função para coletar os dados do formulário com verificação de existência
  function coletarDadosFormulario() {
    // Função auxiliar para obter valor com segurança
    function getValueSafely(id) {
      const element = document.getElementById(id);
      return element ? element.value : '';
    }
    
    // Função auxiliar para verificar checkbox com segurança
    function isCheckedSafely(id) {
      const element = document.getElementById(id);
      return element ? element.checked : false;
    }
    
    // Combina hora de início e término
    const horaInicio = getValueSafely("hora_inicio");
    const horaTermino = getValueSafely("hora_termino");
    const horaInicioTermino = horaInicio && horaTermino 
      ? `Início: ${horaInicio} - Término: ${horaTermino}` 
      : '';
    
    // Prepara os dados dos tipos de trabalho
    const trabalhoEmAltura = isCheckedSafely("trabalho_em_altura") ? "Sim" : "Não";
    const energiasPerigosas = isCheckedSafely("energias_perigosas") ? "Sim" : "Não";
    const equipamentosMoveis = isCheckedSafely("equipamentos_moveis") ? "Sim" : "Não";
    const icamentoDeCargas = isCheckedSafely("icamento_de_cargas") ? "Sim" : "Não";
    const espacoConfinado = isCheckedSafely("espaco_confinado") ? "Sim" : "Não";
    
    // Coleta os riscos selecionados para incluir em "outras_atividades"
    let outrasAtividades = "";
    
    for (const [checkboxId, tipoFormatado] of Object.entries(mapeamentoTipos)) {
      if (isCheckedSafely(checkboxId)) {
        const atividade = mapeamentoAtividades[tipoFormatado];
        const riscos = [...document.querySelectorAll(`#riscos-${tipoFormatado} input:checked`)].map(el => el.value);
        
        if (riscos.length > 0) {
          outrasAtividades += `${atividade}: ${riscos.join(", ")}; `;
        }
      }
    }
    
    // Dados do formulário com os nomes exatos do modelo
    const dadosFormulario = {
      nome_dos_trabalhadores: getValueSafely("nome_dos_trabalhadores"),
      nome_de_empresa: getValueSafely("nome_de_empresa"),
      numero_do_ptp: getValueSafely("numero_do_ptp"),
      hora_do_inicio_e_previsao_do_termino: horaInicioTermino,
      setor: getValueSafely("setor"),
      local_especifico: getValueSafely("local_especifico"),
      endereco_comercial: getValueSafely("endereco_comercial"),
      trabalho_em_altura: trabalhoEmAltura,
      energia_perigosas: energiasPerigosas,
      equipamentos_moveis: equipamentosMoveis,
      icamento_de_cargas: icamentoDeCargas,
      espaco_confinado: espacoConfinado,
      outras_atividades: outrasAtividades,
      // Campos de assinatura podem ser preenchidos posteriormente ou deixados vazios
      assinatura_do_responavel_da_equipe_de_trabalho: "",
      assinatura_do_responsavel_do_sites: "",
      assinatura_do_tecnico_de_seguranca: ""
    };
    
    return dadosFormulario;
  }

  // Adiciona o botão de loading ao HTML se ainda não existir
  function adicionarBotaoLoading() {
    const submitBtn = document.querySelector('#formulario button[type="submit"]');
    if (submitBtn && !submitBtn.dataset.loadingAdded) {
      submitBtn.dataset.loadingAdded = "true";
      submitBtn.dataset.originalText = submitBtn.innerHTML;
      
      // Adiciona estilos para o spinner se ainda não existirem
      if (!document.getElementById('spinner-styles')) {
        const style = document.createElement('style');
        style.id = 'spinner-styles';
        style.textContent = `
          .spinner-border {
            display: inline-block;
            width: 1rem;
            height: 1rem;
            vertical-align: text-bottom;
            border: 0.2em solid currentColor;
            border-right-color: transparent;
            border-radius: 50%;
            animation: spinner-border .75s linear infinite;
          }
          @keyframes spinner-border {
            to { transform: rotate(360deg); }
          }
        `;
        document.head.appendChild(style);
      }
    }
  }

  // Mostra o indicador de loading no botão
  function mostrarLoading(show = true) {
    const submitBtn = document.querySelector('#formulario button[type="submit"]');
    if (submitBtn) {
      if (show) {
        submitBtn.disabled = true;
        submitBtn.innerHTML = `
          <span class="spinner-border" role="status" aria-hidden="true"></span>
          Enviando...
        `;
      } else {
        submitBtn.disabled = false;
        submitBtn.innerHTML = submitBtn.dataset.originalText || "Enviar";
      }
    }
  }

  // Adiciona o botão de loading quando o DOM estiver pronto
  document.addEventListener('DOMContentLoaded', adicionarBotaoLoading);

  document
    .getElementById("formulario")
    .addEventListener("submit", function (e) {
      e.preventDefault();

      // Validação básica
      const campos = [
        "nome_dos_trabalhadores",
        "nome_de_empresa",
        "setor",
        "numero_do_ptp",
        "local_especifico",
        "endereco_comercial",
        "hora_inicio",
        "hora_termino",
      ];

      let valido = true;
      campos.forEach((campo) => {
        const elemento = document.getElementById(campo);
        if (elemento && !elemento.value.trim()) {
          elemento.style.borderColor = "red";
          valido = false;
        } else if (elemento) {
          elemento.style.borderColor = "#ced4da";
        }
      });

      if (!valido) {
        mostrarAlerta(
          "Por favor, preencha todos os campos obrigatórios.",
          "danger"
        );
        return;
      }

      // Verificar se pelo menos um tipo de trabalho foi selecionado
      const tiposTrabalho = [
        "trabalho_em_altura",
        "espaco_confinado",
        "icamento_de_cargas",
        "equipamentos_moveis",
        "energias_perigosas",
      ];

      const temTipoSelecionado = tiposTrabalho.some(
        (tipo) =>
          document.getElementById(tipo) &&
          document.getElementById(tipo).checked
      );

      if (!temTipoSelecionado) {
        mostrarAlerta(
          "Selecione pelo menos um tipo de trabalho.",
          "warning"
        );
        return;
      }

      // Mostrar loading
      mostrarLoading(true);

      // Coletar dados do formulário
      const dadosFormulario = coletarDadosFormulario();
      
      console.log("Enviando dados:", dadosFormulario);
      
      // Enviar dados para a API
      fetch('/Formulario/criar', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(dadosFormulario)
      })
      .then(response => {
        if (!response.ok) {
          throw new Error('Erro ao enviar formulário: ' + response.status);
        }
        return response.json();
      })
      .then(data => {
        console.log('Formulário enviado com sucesso:', data);
        mostrarLoading(false);
        mostrarAlerta(
          "Formulário enviado com sucesso! Redirecionando...",
          "success"
        );
        
        // Redirecionar após 2 segundos
        setTimeout(() => {
          window.location.href = "./home.html";
        }, 2000);
      })
      .catch(error => {
        console.error('Erro:', error);
        mostrarLoading(false);
        mostrarAlerta(
          "Erro ao enviar o formulário: " + error.message,
          "danger"
        );
      });
    });

  function mostrarAlerta(mensagem, tipo) {
    const alertContainer = document.getElementById("alert-container");
    if (alertContainer) {
      alertContainer.innerHTML = `
        <div class="alert alert-${tipo} alert-dismissible fade show" role="alert">
          ${mensagem}
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      `;

      // Scroll para o alerta
      alertContainer.scrollIntoView({ behavior: "smooth" });
    } else {
      console.error("Elemento alert-container não encontrado");
      alert(mensagem); // Fallback para alert padrão
    }
  }
</script>
  </body>
</html>
